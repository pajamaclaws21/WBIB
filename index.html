<!DOCTYPE html>
<html>
  <head>
    <title>WBIB Viewer</title>
    <link rel="icon" type="image/jpg" href=""/>
<style>
	iframe {
    position: fixed;
    top: 0px;
    bottom: 0px;
    right: 0px;
    width: 100%;
    border: none;
    margin: 0;
    padding: 0;
    overflow: hidden;
    z-index: 997;
    height: 100%;
	}
	
	input.site {
	position: relative;
	z-index: 999;
	width: 100px;
	opacity: 0.2;
	}
	
	input.site:hover, input.site:focus {
	position: relative;
	z-index: 999;
	width: 200px;
	opacity: 1;
	}
</style>
  </head>
  <body>
    <input class="site" type="text" id="siteinput" name="siteinput" placeholder="Site">
    <iframe id="embedsite"></iframe>
    <script>
function loadText(text) {
var html_string = text;
document.getElementById('embedsite').srcdoc = html_string;
};
function loadFavicon() {
var favicon = document.querySelector('[rel=icon]');
var step1 = document.getElementById('siteinput').value;
var step2 = step1.split('.');
var step2 = step2[step2.length - 1];
var step2 = step2.split('/');
var step3 = step2[0];
var step3 = step1.split(step3);
var step3 = step3[0] + step2[0] + '/favicon.ico';
var step4 = "https://t0.gstatic.com/faviconV2?client=SOCIAL&type=FAVICON&fallback_opts=TYPE,SIZE,URL&url=" + step3 + "&size=16"ÃÅ;
favicon.href = step4;
};
function fullLoad(text) {
loadText(text);
loadFavicon();
};
function myFunction() {
        loadText('<br><br><p>Loading...</p>');
	var site = document.getElementById('siteinput').value;
	fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(site)}`)
                    .then(response => {
                      if (response.ok) return response.json()
		      document.getElementById("embedsite").innerHTML = 'Uh-oh, the website has run into an error. (Error code: Proxy&RES-NOT-OK)';
                      throw new Error('Network response was not ok.')
                    })
                    .then(data => fullLoad(data.contents));
};
    var siteinput = document.getElementById("siteinput");
siteinput.addEventListener("keydown", function (e) {
    if (e.code === "Enter") {
        myFunction();
    }
});
</script>
  </body>
</html>
